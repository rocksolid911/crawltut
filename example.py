# examples/complete_usage_examples.py
"""
Complete usage examples for the election data extraction system
"""
import asyncio
import os
import sys

# Add parent directory to path for imports
sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from main import ElectionDataExtractor
from processors.csv_processor import CSVProcessor
from processors.profile_processor import ProfileProcessor
from utils.file_manager import ElectionFileManager
from config.election_config import ELECTION_CONFIGS


async def step_by_step_andhra_pradesh_example():
    """Step-by-step example: Extract Andhra Pradesh Assembly data"""
    print("üöÄ STEP-BY-STEP ANDHRA PRADESH ASSEMBLY EXTRACTION")
    print("=" * 60)
    print()

    print("üìÅ Target folder structure:")
    print("state_assembly/ANDHRA PRADESH/{district}/{candidate_name}/{candidate_name}_mla.json")
    print()

    extractor = ElectionDataExtractor()

    # ========== STEP 1: Extract constituency links ==========
    print("üìã STEP 1: Extracting constituency links...")
    print("-" * 40)
    try:
        await extractor.extract_constituencies(
            "https://www.myneta.info/AndhraPradesh2024/",
            election_type="andhra_pradesh"
        )
        print("‚úÖ SUCCESS: Constituency links extracted!")
        print("üìÇ Files created:")
        print("   - state_assembly/ANDHRA PRADESH/constituencies_links_2024.md")
        print("   - state_assembly/ANDHRA PRADESH/constituencies_links_2024.txt")
        print("   - state_assembly/ANDHRA PRADESH/raw_result_2024.html")
    except Exception as e:
        print(f"‚ùå ERROR in Step 1: {e}")
        return
    print()

    # ========== STEP 2: Extract candidate data ==========
    print("üë• STEP 2: Extracting candidate data from constituencies...")
    print("-" * 40)
    try:
        await extractor.extract_candidates("2024", "andhra_pradesh")
        print("‚úÖ SUCCESS: Candidate data extracted!")
        print("üìÇ Data saved to: state_assembly/ANDHRA PRADESH/{district}/")
        print("   Example: state_assembly/ANDHRA PRADESH/AMALAPURAM/AMALAPURAM_123.md")
    except Exception as e:
        print(f"‚ùå ERROR in Step 2: {e}")
        return
    print()

    # ========== STEP 3: Convert markdown to CSV ==========
    print("üìä STEP 3: Converting candidate data to CSV format...")
    print("-" * 40)
    try:
        config = ELECTION_CONFIGS["andhra_pradesh"]
        csv_processor = CSVProcessor(config)
        csv_processor.extract_candidate_tables_to_csv()
        print("‚úÖ SUCCESS: CSV files created!")
        print("üìÇ CSV files location:")
        print("   - state_assembly/ANDHRA PRADESH/AMALAPURAM/AMALAPURAM.csv")
        print("   - state_assembly/ANDHRA PRADESH/VIJAYAWADA/VIJAYAWADA.csv")
        print("   - (and other districts...)")
    except Exception as e:
        print(f"‚ùå ERROR in Step 3: {e}")
        return
    print()

    # ========== STEP 4: Extract detailed profiles ==========
    print("ü§ñ STEP 4: Extracting detailed candidate profiles...")
    print("-" * 40)
    print("Now you can extract detailed profiles using:")
    print()
    print("üîß COMMAND OPTIONS:")
    print("A) Extract ALL candidates:")
    print(
        "   python cli.py profiles --csv-path 'state_assembly/ANDHRA PRADESH/AMALAPURAM/AMALAPURAM.csv' --election-type andhra_pradesh")
    print()
    print("B) Extract WINNERS ONLY:")
    print(
        "   python cli.py profiles --csv-path 'state_assembly/ANDHRA PRADESH/AMALAPURAM/AMALAPURAM.csv' --election-type andhra_pradesh --winners-only")
    print()
    print("üìÅ Profile files will be created as:")
    print("   state_assembly/ANDHRA PRADESH/AMALAPURAM/Dorababu_Yalla/Dorababu_Yalla_mla.json")
    print("   state_assembly/ANDHRA PRADESH/AMALAPURAM/Pawan_Kalyan/Pawan_Kalyan_mla.json")
    print()

    print("üéâ COMPLETE! Your Andhra Pradesh Assembly data extraction is ready!")
    print("=" * 60)


async def verify_existing_lok_sabha_data():
    """Verify that existing Lok Sabha data structure is preserved"""
    print("üîç VERIFYING LOK SABHA DATA COMPATIBILITY")
    print("=" * 50)
    print()

    print("üìÅ Your existing Lok Sabha structure (UNCHANGED):")
    print("constituency_data/2024/ANDHRA PRADESH/AMALAPURAM/Dorababu_Yalla/Dorababu_Yalla.json")
    print()

    # Check if existing data exists
    existing_paths = [
        "constituency_data/2024",
        "constituency_data/2024/ANDHRA PRADESH",
    ]

    print("üîç Checking existing data...")
    for path in existing_paths:
        if os.path.exists(path):
            print(f"‚úÖ Found: {path}")
        else:
            print(f"‚ÑπÔ∏è  Not found: {path} (will be created when needed)")
    print()

    print("üß™ TESTING LOK SABHA COMMANDS:")
    print("1Ô∏è‚É£ Process existing CSV data:")
    print("   python cli.py csv --election-type lok_sabha")
    print()
    print("2Ô∏è‚É£ Extract new Lok Sabha data:")
    print("   python cli.py constituencies --url 'https://www.myneta.info/LokSabha2024/' --election-type lok_sabha")
    print("   python cli.py candidates --year 2024 --election-type lok_sabha --state KARNATAKA")
    print()
    print("3Ô∏è‚É£ Extract detailed profiles (creates .json files):")
    print(
        "   python cli.py profiles --csv-path 'constituency_data/2024/ANDHRA PRADESH/AMALAPURAM/AMALAPURAM.csv' --election-type lok_sabha")
    print()

    print("‚úÖ Your existing Lok Sabha data continues to work exactly as before!")
    print("=" * 50)


def demonstrate_cli_commands():
    """Demonstrate all CLI commands with practical examples"""
    print("üíª CLI COMMANDS DEMONSTRATION")
    print("=" * 40)
    print()

    print("üèõÔ∏è ANDHRA PRADESH ASSEMBLY COMMANDS:")
    print("-" * 30)
    print("Step 1 - Extract constituencies:")
    print("python cli.py constituencies \\")
    print("    --url 'https://www.myneta.info/AndhraPradesh2024/' \\")
    print("    --election-type andhra_pradesh")
    print()

    print("Step 2 - Extract candidates:")
    print("python cli.py candidates \\")
    print("    --year 2024 \\")
    print("    --election-type andhra_pradesh")
    print()

    print("Step 3 - Generate CSV files:")
    print("python cli.py csv \\")
    print("    --election-type andhra_pradesh")
    print()

    print("Step 4 - Extract detailed profiles:")
    print("# All candidates:")
    print("python cli.py profiles \\")
    print("    --csv-path 'state_assembly/ANDHRA PRADESH/AMALAPURAM/AMALAPURAM.csv' \\")
    print("    --election-type andhra_pradesh")
    print()
    print("# Winners only:")
    print("python cli.py profiles \\")
    print("    --csv-path 'state_assembly/ANDHRA PRADESH/AMALAPURAM/AMALAPURAM.csv' \\")
    print("    --election-type andhra_pradesh \\")
    print("    --winners-only")
    print()

    print("üèõÔ∏è LOK SABHA COMMANDS (Existing structure):")
    print("-" * 30)
    print("Extract constituencies:")
    print("python cli.py constituencies \\")
    print("    --url 'https://www.myneta.info/LokSabha2024/' \\")
    print("    --election-type lok_sabha")
    print()

    print("Extract candidates for specific state:")
    print("python cli.py candidates \\")
    print("    --year 2024 \\")
    print("    --election-type lok_sabha \\")
    print("    --state KARNATAKA")
    print()

    print("Extract detailed profiles:")
    print("python cli.py profiles \\")
    print("    --csv-path 'constituency_data/2024/ANDHRA PRADESH/AMALAPURAM/AMALAPURAM.csv' \\")
    print("    --election-type lok_sabha")
    print()


async def python_api_examples():
    """Show how to use the Python API directly"""
    print("üêç PYTHON API USAGE EXAMPLES")
    print("=" * 40)
    print()

    print("üìã Example 1: Basic API usage")
    print("-" * 20)
    print("""
from main import ElectionDataExtractor

async def extract_assembly_data():
    extractor = ElectionDataExtractor()

    # Extract Andhra Pradesh Assembly
    await extractor.extract_constituencies(
        "https://www.myneta.info/AndhraPradesh2024/",
        election_type="andhra_pradesh"
    )

    # Extract candidate data
    await extractor.extract_candidates("2024", "andhra_pradesh")

# Run it
asyncio.run(extract_assembly_data())
""")

    print("üìä Example 2: CSV processing")
    print("-" * 20)
    print("""
from processors.csv_processor import CSVProcessor
from config.election_config import ELECTION_CONFIGS

# Process markdown files to CSV
config = ELECTION_CONFIGS["andhra_pradesh"]
csv_processor = CSVProcessor(config)
csv_processor.extract_candidate_tables_to_csv()
""")

    print("ü§ñ Example 3: Profile extraction")
    print("-" * 20)
    print("""
from processors.profile_processor import ProfileProcessor
from utils.file_manager import ElectionFileManager

async def extract_profiles():
    config = ELECTION_CONFIGS["andhra_pradesh"]
    file_manager = ElectionFileManager()
    processor = ProfileProcessor(config, file_manager)

    # Extract profiles for winners only
    await processor.process_candidates_from_csv(
        "state_assembly/ANDHRA PRADESH/AMALAPURAM/AMALAPURAM.csv",
        winners_only=True,
        batch_size=5
    )

asyncio.run(extract_profiles())
""")


def show_file_naming_examples():
    """Show concrete examples of file naming patterns"""
    print("üè∑Ô∏è FILE NAMING PATTERNS")
    print("=" * 30)
    print()

    print("üìÅ LOK SABHA (MP) - Existing naming preserved:")
    print("constituency_data/2024/ANDHRA PRADESH/AMALAPURAM/")
    print("‚îú‚îÄ‚îÄ Dorababu_Yalla/")
    print("‚îÇ   ‚îî‚îÄ‚îÄ Dorababu_Yalla.json           ‚Üê MP file")
    print("‚îú‚îÄ‚îÄ Pawan_Kalyan/")
    print("‚îÇ   ‚îî‚îÄ‚îÄ Pawan_Kalyan.json             ‚Üê MP file")
    print("‚îú‚îÄ‚îÄ Y_S_Jagan_Mohan_Reddy/")
    print("‚îÇ   ‚îî‚îÄ‚îÄ Y_S_Jagan_Mohan_Reddy.json    ‚Üê MP file")
    print("‚îî‚îÄ‚îÄ AMALAPURAM.csv")
    print()

    print("üìÅ STATE ASSEMBLY (MLA) - New _mla naming:")
    print("state_assembly/ANDHRA PRADESH/AMALAPURAM/")
    print("‚îú‚îÄ‚îÄ Dorababu_Yalla/")
    print("‚îÇ   ‚îî‚îÄ‚îÄ Dorababu_Yalla_mla.json       ‚Üê MLA file")
    print("‚îú‚îÄ‚îÄ Pawan_Kalyan/")
    print("‚îÇ   ‚îî‚îÄ‚îÄ Pawan_Kalyan_mla.json         ‚Üê MLA file")
    print("‚îú‚îÄ‚îÄ Y_S_Jagan_Mohan_Reddy/")
    print("‚îÇ   ‚îî‚îÄ‚îÄ Y_S_Jagan_Mohan_Reddy_mla.json ‚Üê MLA file")
    print("‚îî‚îÄ‚îÄ AMALAPURAM.csv")
    print()

    print("‚ú® Benefits:")
    print("‚úÖ Easy to distinguish MP vs MLA data")
    print("‚úÖ Candidate name remains in filename")
    print("‚úÖ Consistent with existing MP naming pattern")
    print("‚úÖ Clear identification of election type")


def show_folder_comparison():
    """Show side-by-side folder structure comparison"""
    print("üìä FOLDER STRUCTURE COMPARISON")
    print("=" * 50)
    print()

    print("üîÑ BEFORE (Your existing structure) vs AFTER (Enhanced system)")
    print()

    print("BEFORE - Only Lok Sabha:")
    print("constituency_data/")
    print("‚îî‚îÄ‚îÄ 2024/")
    print("    ‚îî‚îÄ‚îÄ ANDHRA PRADESH/")
    print("        ‚îî‚îÄ‚îÄ AMALAPURAM/")
    print("            ‚îú‚îÄ‚îÄ Dorababu_Yalla/")
    print("            ‚îÇ   ‚îî‚îÄ‚îÄ Dorababu_Yalla.json")
    print("            ‚îî‚îÄ‚îÄ AMALAPURAM.csv")
    print()

    print("AFTER - Both Lok Sabha + Assembly:")
    print("your-project/")
    print("‚îú‚îÄ‚îÄ constituency_data/          ‚Üê UNCHANGED")
    print("‚îÇ   ‚îî‚îÄ‚îÄ 2024/")
    print("‚îÇ       ‚îî‚îÄ‚îÄ ANDHRA PRADESH/")
    print("‚îÇ           ‚îî‚îÄ‚îÄ AMALAPURAM/")
    print("‚îÇ               ‚îú‚îÄ‚îÄ Dorababu_Yalla/")
    print("‚îÇ               ‚îÇ   ‚îî‚îÄ‚îÄ Dorababu_Yalla.json      ‚Üê SAME")
    print("‚îÇ               ‚îî‚îÄ‚îÄ AMALAPURAM.csv")
    print("‚îÇ")
    print("‚îî‚îÄ‚îÄ state_assembly/             ‚Üê NEW")
    print("    ‚îú‚îÄ‚îÄ ANDHRA PRADESH/")
    print("    ‚îÇ   ‚îî‚îÄ‚îÄ AMALAPURAM/")
    print("    ‚îÇ       ‚îú‚îÄ‚îÄ Dorababu_Yalla/")
    print("    ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ Dorababu_Yalla_mla.json      ‚Üê NEW")
    print("    ‚îÇ       ‚îî‚îÄ‚îÄ AMALAPURAM.csv")
    print("    ‚îú‚îÄ‚îÄ KARNATAKA/")
    print("    ‚îî‚îÄ‚îÄ TELANGANA/")
    print()

    print("üéØ KEY POINTS:")
    print("‚úÖ Your existing data is 100% preserved")
    print("‚úÖ New assembly data goes to separate folder")
    print("‚úÖ Clear naming distinction: .json vs _mla.json")
    print("‚úÖ Both structures work simultaneously")


async def complete_workflow_example():
    """Show a complete end-to-end workflow"""
    print("üîÑ COMPLETE WORKFLOW EXAMPLE")
    print("=" * 40)
    print()

    print("üéØ Goal: Extract complete Andhra Pradesh Assembly election data")
    print()

    print("‚è∞ ESTIMATED TIME: 30-60 minutes (depending on network speed)")
    print()

    print("üìã WORKFLOW STEPS:")
    print()

    print("1Ô∏è‚É£ PREPARATION (1 minute)")
    print("   pip install -r requirements.txt")
    print("   # Ensure your AI module is integrated")
    print()

    print("2Ô∏è‚É£ EXTRACT CONSTITUENCY LINKS (2-3 minutes)")
    print("   python cli.py constituencies \\")
    print("       --url 'https://www.myneta.info/AndhraPradesh2024/' \\")
    print("       --election-type andhra_pradesh")
    print("   # Creates: state_assembly/ANDHRA PRADESH/constituencies_links_2024.md")
    print()

    print("3Ô∏è‚É£ EXTRACT CANDIDATE DATA (15-30 minutes)")
    print("   python cli.py candidates \\")
    print("       --year 2024 \\")
    print("       --election-type andhra_pradesh")
    print("   # Creates: markdown files for each constituency")
    print()

    print("4Ô∏è‚É£ GENERATE CSV FILES (1-2 minutes)")
    print("   python cli.py csv \\")
    print("       --election-type andhra_pradesh")
    print("   # Creates: CSV files in each district folder")
    print()

    print("5Ô∏è‚É£ EXTRACT DETAILED PROFILES (10-30 minutes)")
    print("   # For specific constituency:")
    print("   python cli.py profiles \\")
    print("       --csv-path 'state_assembly/ANDHRA PRADESH/AMALAPURAM/AMALAPURAM.csv' \\")
    print("       --election-type andhra_pradesh \\")
    print("       --winners-only")
    print()
    print("   # Or batch process all constituencies with a script")
    print()

    print("üìä FINAL RESULT:")
    print("‚úÖ Complete candidate database with profiles")
    print("‚úÖ CSV files for easy analysis")
    print("‚úÖ JSON files for detailed information")
    print("‚úÖ Markdown files for human-readable data")
    print()

    print("üéâ SUCCESS! You now have comprehensive Andhra Pradesh Assembly election data!")


def main_menu():
    """Interactive menu for running examples"""
    print("üöÄ ELECTION DATA EXTRACTION SYSTEM - USAGE EXAMPLES")
    print("=" * 60)
    print()

    examples = {
        "1": ("Step-by-step Andhra Pradesh extraction", step_by_step_andhra_pradesh_example),
        "2": ("Verify existing Lok Sabha compatibility", verify_existing_lok_sabha_data),
        "3": ("CLI commands demonstration", demonstrate_cli_commands),
        "4": ("Python API examples", python_api_examples),
        "5": ("File naming patterns", show_file_naming_examples),
        "6": ("Folder structure comparison", show_folder_comparison),
        "7": ("Complete workflow example", complete_workflow_example),
    }

    print("üìã AVAILABLE EXAMPLES:")
    for key, (description, _) in examples.items():
        print(f"   {key}. {description}")
    print("   0. Show all examples")
    print()

    choice = input("üî¢ Enter your choice (0-7): ").strip()
    print()

    if choice == "0":
        print("üìñ SHOWING ALL EXAMPLES...")
        print("=" * 60)
        for key, (description, func) in examples.items():
            print(f"\n\nüî∏ {description.upper()}")
            print("=" * len(description))
            if asyncio.iscoroutinefunction(func):
                asyncio.run(func())
            else:
                func()
    elif choice in examples:
        description, func = examples[choice]
        print(f"üìñ {description.upper()}")
        print("=" * len(description))
        if asyncio.iscoroutinefunction(func):
            asyncio.run(func())
        else:
            func()
    else:
        print("‚ùå Invalid choice. Please run the script again and choose 0-7.")


if __name__ == "__main__":
    main_menu()